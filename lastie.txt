// lastie beta 0.2
// by Magnic

setgloabal last_index_name ""
setgloabal last_index_creature ""
setgloabal name_repeater ""
setgloabal creature_repeater ""

"/last"
{
set Mname @text.word[1]
set Pname @text.word[0]
set chklistnum 0
if @text.num_words < 1
	goto usage
end if
// if monster always on list, add the name
if Mname >= last_index_creature
	label monster_index_finder
	if last_index_creature.word[chklistnum] != ""
		if last_index_creature.word[chklistnum] == Mname
			setgloabal name_repeater last_index_name
				@textsel "/setlsname "name_repeater" "Pname"[chklistnum]" 
					"\r"
						set chklistnum 0
							goto added
		else if last_index_creature.word[chklistnum] != Mname
			set chklistnum + 1
				goto monster_index_finder
		end if
	end if
else
	setgloabal creature_repeater last_index_creature
		@textsel "/setlscreature "creature_repeater" "Mname" 
			"\r"
				set new_index_number last_index_creature.num_words
					set new_index_number +1
						@textsel "/setlsname "name_repeater" "Pname"[new_index_number]" 
							"\r"
								goto added
end if
label usage
	Message "Usage: /last <name> <monster>"
		goto end
label added
message "Pname" "Mname" added\r"
label end
}

"/setlscreature"
{
setgloabal last_index_creature @text
}

"/setlsname"
{
setgloabal last_index_name @text
}

"/lasts"
{
set names last_index_name
set monsters last_index_creature
set limitn names.num_words
set limitm monsters.num_words
set listnumb 0
set monslist 0
label spittingnames
if names.word[listnumb] != ""
	set myguy names.word[listnumb]
		set myguysnumber myguy.num_letters
			if myguysnumber.letter[myguysnumber.num_letters-1] == monsters.word[monslist]
				"/narrator "myguy" "monsters.word[monslist] \r"
			else
				if monslist > limitm
					goto end
				end if
				monslist + 1
					if listnumb > limitn
						goto spittingnames
					else
						goto end
					end if
			end if
end if
//"/narrator "" last_index_name "\r"
label end
}